<Ui xmlns="http://www.blizzard.com/wow/ui/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.blizzard.com/wow/ui/ ..\..\FrameXML\UI.xsd">

<!-- Copyright 2011-2017 Mike Battersby -->

<Script file="Advanced.lua" />

<Button name="LiteMountOptionsAdvancedKeyBindingTemplate" inherits="UIMenuButtonStretchTemplate" virtual="true">
    <Size x="128" y="22" />
    <Layers>
        <Layer level="OVERLAY">
            <Texture parentKey="selectedHighlight" file="Interface\Buttons\UI-Silver-Button-Select" alphaMode="ADD" hidden="true">
                <Size x="128" y="20" />
                <Anchors>
                    <Anchor point="CENTER" x="0" y="-3" />
                </Anchors>
            </Texture>
        </Layer>
    </Layers>
    <NormalFont style="GameFontHighlightSmall"/>
    <DisabledFont style="GameFontDisable"/>
    <HighlightFont style="GameFontHighlightSmall"/>
    <Scripts>
        <OnClick function="LiteMountOptionsAdvancedBinding_OnClick" />
        <OnLoad>
            self:RegisterForClicks("AnyUp")
        </OnLoad>
    </Scripts>
</Button>

<!-- Button, so that we can bind keys pressed anywhere inside it. -->
<Button name="LiteMountOptionsAdvanced" hidden="true" inherits="LiteMountOptionsPanelTemplate">

    <Layers>
        <Layer level="ARTWORK">
            <FontString parentKey="ExplainText" inherits="GameFontNormal" justifyV="TOP" justifyH="LEFT" text="LM_ADVANCED_EXP">
                <Anchors>
                    <Anchor point="TOP" y="-48" />
                    <Anchor point="LEFT" x="48" />
                    <Anchor point="RIGHT" x="-48" />
                </Anchors>
            </FontString>
        </Layer>
    </Layers>

    <Frames>
        <Frame name="$parentEditBoxContainer" parentKey="EditBoxContainer">

            <Anchors>
                <Anchor point="TOP" y="-160" />
                <Anchor point="LEFT" x="32" />
                <Anchor point="RIGHT" x="-32" />
                <Anchor point="BOTTOM" y="48" />
            </Anchors>

            <Backdrop edgefile="Interface\Tooltips\UI-Tooltip-Border" bgfile="Interface\Tooltips\UI-Tooltip-Background" tile="true">
                <EdgeSize val="16" />
                <TileSize val="16" />
                <BackgroundInsets>
                    <AbsInset left="5" right="5" top="5" bottom="5" />
                </BackgroundInsets>
            </Backdrop>

            <Scripts>
                <OnLoad>
                    self:SetBackdropBorderColor(0.6, 0.6, 0.6, 0.8)
                    self:SetBackdropColor(0, 0, 0, 0.5)
                </OnLoad>
            </Scripts>
        </Frame>

        <EditBox name="$parentEditBox" parentKey="EditBox" multiLine="true" autoFocus="false">

            <Anchors>
                <Anchor point="TOPLEFT" x="8" y="-8" relativeKey="$parent.EditBoxContainer" />
                <Anchor point="BOTTOMRIGHT" x="-8" y="8" relativeKey="$parent.EditBoxContainer" />
            </Anchors>

            <Scripts>
                <OnTextChanged function="LiteMountOptionsControl_OnChanged" />
                <OnEscapePressed function="EditBox_ClearFocus" />
                <OnLoad>
                    self.SetOption = function (self, v, i)
                            if v == LiteMount.actions[i].defaultActionList then
                                LM_Options.db.profile.buttonActions[i] = nil
                            else
                                LM_Options.db.profile.buttonActions[i] = v
                            end
                        end
                    self.GetOption = function (self, i)
                            return LiteMount.actions[i]:CurrentActionList()
                        end
                    self.GetOptionDefault = function (self, i)
                            return LiteMount.actions[i].defaultActionList
                        end
                    LiteMountOptionsControl_OnLoad(self)
                </OnLoad>
            </Scripts>
            <FontString inherits="GameFontHighlight" />
        </EditBox>

        <Button name="$parentUnlockButton" parentKey="UnlockButton" inherits="UIPanelButtonTemplate" text="UNLOCK">
            <Size x="96" y="22" />
            <Anchors>
                <Anchor point="TOPLEFT" relativePoint="BOTTOMLEFT" relativeKey="$parent.EditBoxContainer" x="8" y="-3" />
            </Anchors>
            <Scripts>
                <OnClick function="LiteMountOptionsAdvancedUnlock_OnClick" />
            </Scripts>
        </Button>

        <Frame name="$parentBindingDropDown" parentkey="BindingDropDown" inherits="UIDropDownMenuTemplate">
            <Size x="93" y="22" />
            <Anchors>
                <Anchor point="BOTTOMLEFT" relativePoint="TOPLEFT" relativeKey="$parent.EditBoxContainer" x="-8" />
            </Anchors>
        </Frame>

        <Button parentKey="BindingButton2" inherits="LiteMountOptionsAdvancedKeyBindingTemplate" id="2">
            <Anchors>
                <Anchor point="BOTTOMRIGHT" relativePoint="TOPRIGHT" relativeKey="$parent.EditBoxContainer" x="-8" />
            </Anchors>
        </Button>

        <Button parentKey="BindingButton1" inherits="LiteMountOptionsAdvancedKeyBindingTemplate" id="1">
            <Anchors>
                <Anchor point="BOTTOMRIGHT" relativePoint="TOPRIGHT" relativeKey="$parent.BindingButton2" y="3" />
            </Anchors>
        </Button>

        <EditBox parentKey="docURL" autoFocus="false" ignoreArrows="true">
            <Size y="16" />
            <Fontstring inherits="GameFontHighlight" />
            <Anchors>
                <Anchor point="TOPLEFT" relativeKey="$parent.ExplainText" relativePoint="BOTTOMLEFT" y="-12" x="16" />
                <Anchor point="RIGHT" x="-16" />
            </Anchors>
            <Scripts>
                <OnLoad>
                    self.url = 'https://wow.curseforge.com/projects/litemount/pages/advanced-options'
                </OnLoad>
                <OnShow>
                    self:SetText(self.url)
                </OnShow>
                <OnTextChanged>
                    self:SetText(self.url)
                    self:HighlightText()
                </OnTextChanged>
                <OnEditFocusGained>
                    self:HighlightText()
                </OnEditFocusGained>
                <OnEscapePressed function="EditBox_ClearFocus" />
            </Scripts>
        </EditBox>

    </Frames>

    <Layers>
        <Layer level="ARTWORK">
            <FontString parentKey="BindingLabelText1" inherits="GameFontNormal" text="KEY1">
                <Anchors>
                    <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMLEFT" relativeKey="$parent.BindingButton1" x="-3" y="6" />
                </Anchors>
            </FontString>
            <FontString parentKey="BindingLabelText2" inherits="GameFontNormal" text="KEY2">
                <Anchors>
                    <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMLEFT" relativeKey="$parent.BindingButton2" x="-3" y="6" />
                </Anchors>
            </FontString>
        </Layer>
    </Layers>


    <Scripts>
        <OnLoad function="LiteMountOptionsAdvanced_OnLoad" />
        <OnKeyDown function="LiteMountOptionsAdvanced_OnKeyDown" />
        <OnShow function="LiteMountOptionsAdvanced_OnShow" />
    </Scripts>
</Button>

</Ui>
